#!/usr/bin/env node\n\n/**\n * 간단한 향상된 SUMIFS 테스트\n */\n\nconst EnhancedCalculationEngine = require('./src/engines/EnhancedCalculationEngine');\nconst path = require('path');\n\nasync function simpleTest() {\n  console.log('=== 간단한 향상된 SUMIFS 테스트 ===\\n');\n\n  const excelPath = path.join(__dirname, '..', 'decrypted_sample.xlsx');\n  console.log(`Excel 파일: ${excelPath}`);\n\n  try {\n    // 1. 엔진 초기화\n    console.log('엔진 초기화 중...');\n    const engine = new EnhancedCalculationEngine();\n    \n    // 2. Excel 파일 로드\n    console.log('Excel 파일 로드 중...');\n    await engine.loadExcelFile(excelPath);\n    \n    // 3. 단일 SUMIFS 테스트\n    console.log('\\n단일 SUMIFS 테스트...');\n    const testFormula = {\n      sheet: '월별요약손익계산서(추정)',\n      cell: 'C5',\n      formula: 'SUMIFS(매출내역total!$G:$G,매출내역total!$A:$A,C$2,매출내역total!$J:$J,$B5)',\n      value: 52223360\n    };\n    \n    console.log(`수식: ${testFormula.formula}`);\n    console.log(`Excel 예상값: ${testFormula.value}`);\n    \n    const result = engine.executeSUMIFS(testFormula);\n    console.log(`JavaScript 결과: ${result}`);\n    \n    const match = result === testFormula.value;\n    console.log(`매칭: ${match ? '✅ 성공' : '❌ 실패'}`);\n    \n    if (!match) {\n      console.log(`차이: ${Math.abs(result - testFormula.value)}`);\n    }\n    \n    console.log('\\n테스트 완료!');\n    \n  } catch (error) {\n    console.error('테스트 중 오류:', error);\n  }\n}\n\n// 스크립트 직접 실행 시\nif (require.main === module) {\n  simpleTest().catch(console.error);\n}\n\nmodule.exports = { simpleTest };